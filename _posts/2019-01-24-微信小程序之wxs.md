---
layout: post
title: å¾®ä¿¡å°ç¨‹åºä¹‹wxs
subtitle: 'æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è¯·æ±‚åˆ°çš„jsonæ•°æ®å¹¶ä¸èƒ½ç›´æ¥æ˜¾ç¤ºåˆ°é¡µé¢ä¸­ï¼Œå¯èƒ½éœ€è¦åšæ•°æ®çš„äºŒæ¬¡åŠ å·¥ï¼Œå¾€å¾€æˆ‘ä»¬ä¼šåœ¨pageçš„jsä¸­å¤„ç†ï¼Œè¿™é‡Œæä¾›å¦å¤–ä¸€ç§å¤„ç†æ€è·¯'
date: 2019-01-24 11:28:30
categories: dev
tags: å¾®ä¿¡å°ç¨‹åº
---

* Toc
{:toc}

## å¾®ä¿¡å°ç¨‹åºä¹‹wxs
### 1. åº”ç”¨åœºæ™¯

> å¼€å‘ä¸­æˆ‘ä»¬å¸¸å¸¸é‡åˆ°éœ€è¦æŠŠæœåŠ¡ç«¯ç»™åˆ°çš„æ•°æ®è¿›è¡ŒäºŒæ¬¡åŠ å·¥åï¼Œæ‰èƒ½æ˜¾ç¤ºåˆ°ç•Œé¢ä¸Šï¼›
>
> æ¯”å¦‚é‡‘èç±»Appç»å¸¸ä¸æ˜¾ç¤ºå®Œæ•´çš„é“¶è¡Œå¡å·ã€æ‰‹æœºå·ï¼Œéœ€è¦è¿›ä¸€æ­¥æ‰‹æœºéªŒè¯åæ‰å¯ä»¥æŸ¥çœ‹å®Œæ•´ä¿¡æ¯ï¼›
>
> æ¯”å¦‚ç”Ÿæ—¥ğŸ‚æ—¥æœŸä¸€èˆ¬åªæ˜¾ç¤ºå¹´æœˆæ—¥ï¼Œè€ŒæœåŠ¡ç«¯ç»™çš„æ•°æ®å¯èƒ½æ˜¯å¸¦æ—¶åˆ†ç§’ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ•°æ®åŠ å·¥ï¼›

![wxs-res](/assets/article/2019/01/wxs-res.png)






### 2. å¸¸è§„jså¤„ç†æ–¹å¼

> æ–¹æ³•ä¸€ã€ç½‘ç»œè¯·æ±‚æ‹¿åˆ°æ•°æ®åï¼ŒæŠŠäºŒæ¬¡è¯·æ±‚åçš„ç»“æœç›´æ¥æ›¿æ¢æ‰å½“å‰å­—æ®µ
>
> ç¼ºç‚¹ï¼šä¸¢å¤±æ‰äº†åŸå§‹æ•°æ®



> æ–¹æ³•äºŒã€ç»™å½“å‰æ•°æ®æ¨¡å‹æ–°å¢å­—æ®µï¼Œé¡µé¢ç»‘å®šæ–°å¢çš„å­—æ®µ
>
> ç¼ºç‚¹ï¼šå¦‚æœæ¨¡å‹éœ€è¦äºŒæ¬¡å¤„ç†çš„å­—æ®µå¤ªå¤šï¼Œä¼šé€ æˆè‡ƒè‚¿ï¼Œå¹¶ä¸”æ•°æ®æ¨¡å‹ä¸¤ç«¯ä¸ç»Ÿä¸€ï¼Œå¯èƒ½åç»­ç»´æŠ¤é—®é¢˜

#### WXML

```HTML
<!-- ä½¿ç”¨åŸå§‹å­—æ®µç»‘å®šç•Œé¢ -->
<view style='margin:40px;'>
  <view>ä¼šå‘˜ä¿¡æ¯</view>
  <view>æ‰‹æœºå·ï¼š{\{mobile}\}</view>
  <view>ç”Ÿ æ—¥ï¼š{\{birthday}\}</view>
</view>

<!-- ä½¿ç”¨æ–°å¢å­—æ®µç»‘å®šäºŒæ¬¡å¤„ç†åçš„æ•°æ® -->
<view style='margin:40px;'>
  <view>ä¼šå‘˜ä¿¡æ¯</view>
  <view>æ‰‹æœºå·ï¼š{\{mobile2}\}</view>
  <view>ç”Ÿ æ—¥ï¼š{\{birthday2}\}</view>
</view>
```

#### JS

```js
Page({
  data: {
    mobile: "", // æœåŠ¡ç«¯è¿”å›çš„åŸå§‹å­—æ®µ
    birthday: "", // æœåŠ¡ç«¯è¿”å›çš„åŸå§‹å­—æ®µ
    mobile2: "", // è‡ªå·±å¢åŠ çš„æ–°å­—æ®µ
    birthday2: ""  // è‡ªå·±å¢åŠ çš„æ–°å­—æ®µ
  },

  onLoad: function() {
    
    // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚
    setTimeout(()=>{
      // å¾—åˆ°åŸå§‹æ•°æ®
      this.setData({
        mobile: '13959278888',
        birthday: "2018-11-23 08:11:06"
      },()=>{

        // äºŒæ¬¡åŠ å·¥æ•°æ®
        let mobile2 = this.toAnonymousString(this.data.mobile);
        let birthday2 = this.toDateString(this.data.birthday);

        // è®¾ç½®äºŒæ¬¡åŠ å·¥åçš„æ•°æ®
        this.setData({
          mobile: mobile2,
          birthday: birthday2,
          mobile2: mobile2,
          birthday2: birthday2
        });
      })}, 3000);

  },

  /**
  * æŠŠå®Œæ•´çš„æ—¥æœŸè½¬æˆå¹´æœˆæ—¥ï¼Œä¾‹ï¼š"2018-11-23 08:11:06" -> "2018-11-23"
  * */
  toDateString: function (timeString) {
    return timeString.split(" ")[0];
  },

  /**
  * æŠŠæ‰‹æœºå·è½¬æˆåŒ¿åå·ç ï¼Œä¾‹ï¼š13959278888 -> 139****888
  * */
  toAnonymousString: function (string) {
    var list = string.split("");
    for (var i = 0; i < list.length; i++) {
      if (i > 2 && i < 7) {
        list[i] = "*";
      }
    }
    return list.join("");
  }
})

```

#### ç–‘é—®<è®¡ç®—æ€§å±æ€§æƒ³æ³•>ï¼š

>å…¶å®ä¸Šè¿°çš„éœ€æ±‚æ˜¯å¸¸è§çš„è®¡ç®—æ€§å±æ€§é—®é¢˜ï¼Œä»¥ä¸Šå¤„ç†æ–¹å¼ä¸åˆ©äºå¤§é¢ç§¯å‡ºç°è¯¥é—®é¢˜æ—¶ä½¿ç”¨ï¼›
>
>é‚£æœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸æ–°å¢å­—æ®µï¼Œä¹Ÿä¸æ›¿æ¢æ‰åŸå§‹å­—æ®µæ•°æ®çš„æƒ…å†µä¸‹ï¼Œå°†åŠ å·¥åçš„æ•°æ®ç›´æ¥ç»‘å®šåˆ°ç•Œé¢ä¸Šå‘¢ï¼Ÿ
>
>æ¯”å¦‚ç›´æ¥å†™æˆ \<text>{\{this.toAnonymousString(mobile)}\}</text>å‘¢ï¼Ÿ
>
>ç­”ï¼šå…¶å®è¿™ç§éœ€æ±‚åœ¨vueã€angularç­‰MVVMæ¡†æ¶ä¸­æ˜¯æ”¯æŒç±»ä¼¼è¿™ç§å†™æ³•çš„ï¼Œæœ¬è´¨ä¸Šåœ¨é¡µé¢æ–‡ä»¶ä¸­è°ƒç”¨jsæ–¹æ³•ï¼›ä½†æ˜¯å°ç¨‹åºjsä¸­å¹¶æ²¡æœ‰æä¾›è®¡ç®—æ€§å±æ€§çš„å†™æ³•ï¼Œå¯ä»¥ä½¿ç”¨wxsæ¥å®ç°



### 3. wxså¤„ç†æ–¹å¼

> 1ã€å®ƒæœ¬è´¨æ˜¯å¦å¤–ä¸€ç§ä¸œè¥¿ï¼Œä½†æ˜¯ä¼šjsåŸºæœ¬ä¸Šæ— ç¼ä¸Šæ‰‹<æœ‰ä¸€äº›å°åŒºåˆ«ï¼Œæ¯”å¦‚ä¸æ”¯æŒç®­å¤´å‡½æ•°ã€letã€constç­‰ç­‰ï¼Œå¹¶ä¸”æ— æ³•debugger>
>
> 2ã€ä½¿ç”¨wxsç›¸å½“äºåœ¨WXMLé¡µé¢æè¿°æ–‡ä»¶ä¸­åµŒå…¥jsä»£ç ï¼Œå¯ä»¥åšä¸€äº›é€»è¾‘æ“ä½œ
>
> ä¼˜ç‚¹ï¼šå¯ä»¥çµæ´»çš„åµŒå…¥åˆ°é¡µé¢ä¸­ï¼Œä¸åŠ¨åŸå§‹æ•°æ®ï¼Œå¹¶ä¸”éå¸¸é€‚åˆå¤ç”¨
>
> ç¼ºé™·ï¼šå®ƒæ˜¯ç‹¬ç«‹çš„ä¸œè¥¿ï¼Œæ— æ³•è·Ÿjsæ–‡ä»¶åšäº¤äº’ï¼Œå¯¼è‡´jsä¸­å®ç°çš„æ–¹æ³•ç­‰ï¼Œå¦‚æœè¦ç”¨å¿…é¡»é‡æ–°å®ç°ä¸€é

#### WXML

```HTML
<!-- ä½¿ç”¨åŸå§‹å­—æ®µç»‘å®šç•Œé¢ -->
<view style='margin:40px;'>
  <view>ä¼šå‘˜ä¿¡æ¯</view>
  <view>æ‰‹æœºå·ï¼š{\{mobile}\}</view>
  <view>ç”Ÿ æ—¥ï¼š{\{birthday}\}</view>
</view>

<!-- ä½¿ç”¨æ–°å¢å­—æ®µç»‘å®šäºŒæ¬¡å¤„ç†åçš„æ•°æ® -->
<view style='margin:40px;'>
  <view>ä¼šå‘˜ä¿¡æ¯</view>
  <view>æ‰‹æœºå·ï¼š{\{mobile2}\}</view>
  <view>ç”Ÿ æ—¥ï¼š{\{birthday2}\}</view>
</view>

<!-- é¡µé¢ä¸­å¯¼å…¥wxsæ–‡ä»¶ï¼Œmoduleç›¸å½“äºç»™å·¥å…·ç»™ä¸ªç±»åï¼Œè·Ÿæ–‡ä»¶åæ— ä»»ä½•å…³ç³» -->
<wxs src='./StringUtil.wxs' module='StringUtil' />
<!-- è°ƒç”¨æ–¹å¼ -->
<view style='margin:40px;'>
  <view style='color:red;'>å¸Œæœ›æ•ˆæœ:</view>
  <view>1ã€éšè—éƒ¨åˆ†ç”µè¯å·ç </view>
  <text style='color:red;'>{\{StringUtil.toAnonymousString(mobile)}\}</text>
  <view>2ã€åªæ˜¾ç¤ºç”Ÿæ—¥æ—¥æœŸ</view>
  <text style='color:red;'>{\{StringUtil.toDateString(birthday)}\}</text>
</view>
```

#### JS

```js
/**
 * æŠŠå®Œæ•´çš„æ—¥æœŸè½¬æˆå¹´æœˆæ—¥ï¼Œä¾‹ï¼š"2018-11-23 08:11:06" -> "2018-11-23"
 * */
var toDateString = function (timeString) {
  return timeString.split(" ")[0];
}

/**
 * æŠŠæ‰‹æœºå·è½¬æˆåŒ¿åå·ç ï¼Œä¾‹ï¼š13959278888 -> 139****8888
 * */ 
var toAnonymousString = function (string) {
  var list = string.split("");
  for (var i = 0; i < list.length; i++) {
    if (i > 2 && i < 7) {
      list[i] = "*";
    }
  }
  return list.join("");
}

module.exports = {
  toDateString: toDateString,
  toAnonymousString: toAnonymousString
}
```