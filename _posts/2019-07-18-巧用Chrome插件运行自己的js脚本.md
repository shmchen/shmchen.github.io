---
layout: post
title: 巧用Chrome插件运行自己的js脚本
subtitle: '有时候，我想在网站打开后运行一段自己的js代码，比方说挂机网站，网站打开运行一个定时器⏲，每20分钟自动刷新一次或者页面滚动一下，怎样方便的做到呢？'
date: 2019-07-18 09:51:30
categories: dev
tags: web
---

* Toc
{:toc}
> 有时候，我有这么一个需求，想在网站打开后自动执行一段自己的js代码，比方说挂机网站，网站打开的时候运行一个定时器⏲，每20分钟自动刷新一次或者页面滚动一下，怎样方便的做到呢？

## 巧用Chrome插件运行自己的js脚本

### 1. 利用chrome插件Tampermonkey(油猴🐵)

> Tampermonkey(油猴🐵)是一款很出名的chrome插件，它可以在某个网站打开的时候运行一段js脚本，并且支持做一些定制，比如哪个网站要运行这段脚本，哪些网站不需要；
>
> 我们可以在Tampermonkey管理面板中新建自己的脚本，也可以在脚本市场找别人分享好的脚本(比如视频网站去广告脚本、免vip高清视频脚本、百度云盘外链脚本等等...)

### 2. 自己写个Chrome插件

> 油猴用起来还是很方便的，但是我需要的功能很简单，更方便的方法是自己整一个自己的Chrome插件；
>
> 听起来高大上，其实只需要搭一个插件的基本目录，把配置清单填写好，加上js代码即可，并不需要研究太多的插件功能



#### 2.1 创建插件目录及文件

新建一个文件夹，比如，"我的插件"

然后创建一个文本文件，作为这个扩展程序的配置文件，所以文件名是manifest.json，注意扩展名是json，然后输入如下内容。

```js
{
  "name": "第一个Chrome插件",
  "manifest_version": 2,
  "version": "1.0",
  "description": "我的第一个Chrome插件，还不错吧",
  "browser_action": {
    "default_icon": "1.png"
  }
}
```

1.png的话，随便拖一张图片进来就OK啦。另外需要注意的是，该文本文件需要用UTF8字符集保存。

你的第一个chrome扩展就完成了。

什么？完成了？这么快？

#### 2.2 加载插件

确实是，打开chrome，打开菜单，找到扩展程序选项我的在扳手->工具->扩展程序 路径下。

点击加载正在开发的扩展程序

![img](http://img1.tuicool.com/Nv6nya.jpg!web)

可以看到，你的1.png已经作为图标被放在地址栏旁边了。只不过现在毫无功能。

现在让我们把脚本文件路径添加进去。在manifest文件里添加几行这样的代码。

```js
"content_scripts": [
    {
      "matches": ["http://www.baidu.com/*"],
      "js": ["myscript.js"]
    }
  ]
```


注意跟之前的代码用逗号分割开。

可以看到我们新增了一个内容，就是content_scripts，详细的介绍应该去看官方文档，我在这里简要介绍下，content_scripts是运行在打开页面的脚本，可以拿到整个页面的DOM对象，所以可以利用该脚本对页面进行操作。

新建一个js文件myscript.js，里边代码很简单。

```js
console.log("我的脚本已加载");
alert("HelloWorld");
```


在扩展程序页面重新加载插件，就可以去看效果了。